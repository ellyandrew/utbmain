generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model activity_logs_tbl {
  id          Int      @id @default(autoincrement())
  user_id     Int?
  member_id   Int?
  action      String?  @db.VarChar(100)
  description String?  @db.Text
  ip_address  String?  @db.VarChar(45)
  user_agent  String?  @db.VarChar(255)
  created_at  DateTime @default(now()) @db.DateTime(0)
}

model beneficiaries_tbl {
  beneficiary_id Int                      @id @default(autoincrement())
  facility_id    Int?
  full_name      String?                  @db.VarChar(150)
  birth_number   String?                  @db.VarChar(30)
  dob            DateTime?                @db.Date
  gender         String?                  @db.VarChar(20)
  disability     String?                  @db.VarChar(30)
  care_details   String?                  @db.LongText
  birth_doc      String?                  @db.VarChar(255)
  status         beneficiaries_tbl_status @default(Active)
  reg_date       DateTime                 @default(now()) @db.DateTime(0)

  @@index([disability], map: "idx_disability")
  @@index([facility_id], map: "idx_facility")
  @@index([gender], map: "idx_gender")
  @@index([status], map: "idx_status")
}

model benefits_tbl {
  benefit_id  Int      @id @default(autoincrement())
  member_id   Int?
  benefits    String?  @db.LongText
  last_update DateTime @default(now()) @db.DateTime(0)
}

model caregivers_tbl {
  caregiver_id     BigInt                 @id @default(autoincrement())
  facility_id      BigInt
  full_name        String                 @db.VarChar(255)
  gender           caregivers_tbl_gender
  id_number        String?                @db.VarChar(20)
  education_level  String?                @db.VarChar(30)
  disability       String?                @db.VarChar(30)
  phisical_address String?                @db.VarChar(50)
  phone_number     String?                @db.VarChar(50)
  status           caregivers_tbl_status? @default(Active)
  extra_data       String?                @db.LongText
  caregiver_doc    String?                @db.VarChar(255)
  created_at       DateTime               @default(now()) @db.Timestamp(0)

  @@index([disability], map: "idx_disability")
  @@index([education_level], map: "idx_education")
  @@index([facility_id], map: "idx_facility")
  @@index([gender], map: "idx_gender")
  @@index([status], map: "idx_status")
}

model childcare_survey_tbl {
  survey_id                  Int                                         @id @default(autoincrement())
  county_name                String?                                     @db.VarChar(30)
  sub_county_name            String?                                     @db.VarChar(30)
  ward_name                  String?                                     @db.VarChar(30)
  enumerator_name            String?                                     @db.VarChar(150)
  id_number                  String?                                     @unique(map: "idx_unique_idnumber") @db.VarChar(30)
  worker_category            String?                                     @db.VarChar(100)
  gender                     childcare_survey_tbl_gender?
  age                        Int?
  education_level            String?                                     @db.VarChar(50)
  received_training          childcare_survey_tbl_received_training?
  received_certificate       childcare_survey_tbl_received_certificate?
  facility_name              String?                                     @db.VarChar(200)
  facility_classification    String?                                     @db.VarChar(30)
  geo_location               String?                                     @db.VarChar(30)
  year_established           Int?
  total_children             Int?
  girls                      Int?
  boys                       Int?
  age_under6                 Int?
  age_6_12                   Int?
  age_12_24                  Int?
  age_24_36                  Int?
  age_36_plus                Int?
  children_with_disabilities Int?
  boys_with_disabilities     Int?
  girls_with_disabilities    Int?
  total_workers              Int?
  female_workers             Int?
  male_workers               Int?
  workers_with_disabilities  Int?
  member_institutions        String?                                     @db.VarChar(255)
  loan_institutions          String?                                     @db.VarChar(255)
  interested_in_finance      childcare_survey_tbl_interested_in_finance?
  provider_name              String?                                     @db.VarChar(150)
  phone_number               String?                                     @db.VarChar(20)
  status                     childcare_survey_tbl_status?                @default(Draft)
  created_at                 DateTime                                    @default(now()) @db.Timestamp(0)

  @@index([county_name], map: "idx_county")
  @@index([county_name, gender], map: "idx_county_gender")
  @@index([county_name, year_established], map: "idx_county_year")
  @@index([created_at], map: "idx_created_at")
  @@index([enumerator_name], map: "idx_enumerator")
  @@index([enumerator_name, county_name], map: "idx_enumerator_county")
  @@index([gender], map: "idx_gender")
  @@index([status], map: "idx_status")
  @@index([sub_county_name], map: "idx_sub_county")
  @@index([ward_name], map: "idx_ward")
  @@index([worker_category], map: "idx_worker_category")
  @@index([year_established], map: "idx_year_established")
}

model childcare_survey_test {
  survey_id                  Int                                          @id @default(autoincrement())
  county_name                String?                                      @db.VarChar(30)
  sub_county_name            String?                                      @db.VarChar(30)
  ward_name                  String?                                      @db.VarChar(30)
  enumerator_name            String?                                      @db.VarChar(150)
  id_number                  String?                                      @db.VarChar(30)
  worker_category            String?                                      @db.VarChar(100)
  gender                     childcare_survey_test_gender?
  age                        Int?
  education_level            String?                                      @db.VarChar(50)
  received_training          childcare_survey_test_received_training?
  received_certificate       childcare_survey_test_received_certificate?
  facility_name              String?                                      @db.VarChar(200)
  facility_classification    String?                                      @db.VarChar(30)
  geo_location               String?                                      @db.VarChar(30)
  year_established           Int?
  total_children             Int?
  girls                      Int?
  boys                       Int?
  age_under6                 Int?
  age_6_12                   Int?
  age_12_24                  Int?
  age_24_36                  Int?
  age_36_plus                Int?
  children_with_disabilities Int?
  boys_with_disabilities     Int?
  girls_with_disabilities    Int?
  total_workers              Int?
  female_workers             Int?
  male_workers               Int?
  workers_with_disabilities  Int?
  member_institutions        String?                                      @db.VarChar(255)
  loan_institutions          String?                                      @db.VarChar(255)
  interested_in_finance      childcare_survey_test_interested_in_finance?
  provider_name              String?                                      @db.VarChar(150)
  phone_number               String?                                      @db.VarChar(20)
  status                     childcare_survey_test_status?                @default(Draft)
  created_at                 DateTime                                     @default(now()) @db.Timestamp(0)
}

model contributions_tbl {
  contribution_id   Int                                  @id @default(autoincrement())
  sacco_member_id   Int?
  member_id         Int
  contribution_type contributions_tbl_contribution_type? @default(Savings)
  amount            Decimal                              @db.Decimal(12, 2)
  payment_method    contributions_tbl_payment_method?    @default(Cash)
  reference_no      String?                              @db.VarChar(100)
  contribution_date DateTime                             @default(now()) @db.DateTime(0)
  notes             String?                              @db.Text
  status            contributions_tbl_status             @default(Pending)
  created_at        DateTime                             @default(now()) @db.Timestamp(0)
  updated_at        DateTime                             @default(now()) @db.Timestamp(0)

  @@index([contribution_date], map: "idx_contribution_date")
  @@index([contribution_type], map: "idx_contribution_type")
  @@index([sacco_member_id, contribution_date], map: "idx_member_date")
  @@index([payment_method], map: "idx_payment_method")
  @@index([reference_no], map: "idx_reference_no")
  @@index([sacco_member_id], map: "idx_sacco_member_id")
}

model event_logs_tbl {
  event_id Int    @id @default(autoincrement())
  user_id  Int
  activity String @db.VarChar(255)
}

model facilities_tbl {
  facility_id         Int                   @id @default(autoincrement())
  member_id           Int
  facility_name       String?               @db.VarChar(100)
  facility_type       String?               @db.VarChar(20)
  setup_type          String?               @db.VarChar(20)
  facility_estab_year Int?                  @db.Year
  reg_no              String?               @db.VarChar(30)
  license_no          String?               @db.VarChar(30)
  male_b              Int?                  @default(0)
  female_b            Int?                  @default(0)
  male_b_dis          Int?                  @default(0)
  female_b_dis        Int?                  @default(0)
  male_c              Int?                  @default(0)
  female_c            Int?                  @default(0)
  f_county            String?               @db.VarChar(20)
  f_subcounty         String?               @db.VarChar(20)
  f_area              String?               @db.VarChar(30)
  status              facilities_tbl_status @default(Active)
  reg_date            DateTime              @default(now()) @db.DateTime(0)
  total_beneficiaries Int?
  total_caregivers    Int?

  @@index([f_county], map: "idx_county")
  @@index([f_county, f_subcounty], map: "idx_county_subcounty")
  @@index([f_subcounty], map: "idx_subcounty")
  @@index([total_beneficiaries], map: "idx_total_beneficiaries")
  @@index([total_caregivers], map: "idx_total_caregivers")
  @@index([reg_date], map: "reg_date")
  @@fulltext([facility_name], map: "idx_fulltext_facility")
}

model loan_types_tbl {
  loan_type_id    Int      @id @default(autoincrement())
  loan_name       String?  @db.VarChar(30)
  interest_rate   Decimal? @db.Decimal(5, 2)
  max_term_months Int?
  min_amount      Decimal? @db.Decimal(12, 2)
  max_amount      Decimal? @db.Decimal(12, 2)
  created_at      DateTime @default(now()) @db.Timestamp(0)
}

model loans_tbl {
  loan_id          Int                         @id @default(autoincrement())
  sacco_member_id  Int
  loan_type        loans_tbl_loan_type?        @default(Emergency_Loan)
  principal        Decimal                     @db.Decimal(12, 2)
  interest_rate    Decimal?                    @default(0.00) @db.Decimal(5, 2)
  interest_amount  Decimal                     @db.Decimal(12, 2)
  total_repayment  Decimal                     @db.Decimal(12, 2)
  repayment_period Int?                        @default(12)
  repayment_source loans_tbl_repayment_source? @default(Cash_Deposit)
  balance          Decimal?                    @default(0.00) @db.Decimal(12, 2)
  status           loans_tbl_status?           @default(Pending)
  issue_date       DateTime?                   @db.Date
  due_date         DateTime?                   @db.Date
  created_at       DateTime                    @default(now()) @db.Timestamp(0)
  updated_at       DateTime                    @default(now()) @db.Timestamp(0)

  @@index([due_date], map: "idx_due_date")
  @@index([issue_date], map: "idx_issue_date")
  @@index([loan_type], map: "idx_loan_type")
  @@index([sacco_member_id], map: "idx_member_id")
  @@index([status], map: "idx_status")
}

model member_profile_tbl {
  profile_id      Int       @id @default(autoincrement())
  member_id       Int       @unique(map: "unique_member_profile")
  phone           String?   @db.VarChar(15)
  id_number       String?   @db.VarChar(20)
  dob             DateTime? @db.Date
  gender          String?   @db.VarChar(10)
  disability      String?   @db.VarChar(30)
  education_level String?   @db.VarChar(30)
  citizenship     String?   @db.VarChar(20)
  country         String?   @db.VarChar(20)
  county          String?   @db.VarChar(20)
  sub_county      String?   @db.VarChar(30)
  ward            String?   @db.VarChar(30)
  next_kin_name   String?   @db.VarChar(150)
  kin_rln         String?   @db.VarChar(20)
  kin_phone       String?   @db.VarChar(15)
  kin_location    String?   @db.VarChar(50)
  member_doc      String?   @db.VarChar(255)
  member_id_doc   String?   @db.VarChar(255)

  @@index([id_number], map: "idx_id_number")
  @@fulltext([phone], map: "idx_fulltext_phone")
}

model members_tbl {
  member_id       Int                         @id @default(autoincrement())
  membership_no   String?                     @unique(map: "unique_membership") @db.VarChar(30)
  first_name      String?                     @db.VarChar(30)
  middle_name     String?                     @db.VarChar(30)
  last_name       String?                     @db.VarChar(30)
  full_name       String?                     @db.VarChar(255)
  email           String?                     @unique(map: "idx_email") @db.VarChar(100)
  password        String?                     @db.Text
  membership_type members_tbl_membership_type @default(CheckIn)
  role            members_tbl_role            @default(CheckIn)
  status          members_tbl_status          @default(Draft)
  reg_date        DateTime?                   @default(now()) @db.DateTime(0)

  @@index([full_name], map: "idx_full_name")
  @@index([membership_no], map: "idx_membership_no")
  @@index([reg_date], map: "idx_reg_date")
  @@index([status], map: "idx_status")
}

model notification_tbl {
  note_id      Int      @id @default(autoincrement())
  sender_id    String   @db.VarChar(11)
  receiver_id  String   @db.VarChar(11)
  note_title   String   @db.VarChar(20)
  note_content String   @db.VarChar(255)
  status       String   @db.VarChar(10)
  note_time    DateTime @default(now()) @db.DateTime(0)
}

model sacco_members_tbl {
  sacco_member_id Int                       @id @default(autoincrement())
  member_id       Int
  join_date       DateTime?                 @default(now()) @db.DateTime(0)
  membership_no   String?                   @db.VarChar(50)
  shares          Decimal?                  @default(0.00) @db.Decimal(12, 2)
  savings         Decimal?                  @default(0.00) @db.Decimal(12, 2)
  loan_balance    Decimal?                  @default(0.00) @db.Decimal(12, 2)
  status          sacco_members_tbl_status? @default(Active)
  notes           String?                   @db.Text
  created_at      DateTime                  @default(now()) @db.Timestamp(0)
  updated_at      DateTime                  @default(now()) @db.Timestamp(0)

  @@index([member_id], map: "idx_member_id")
}

model settings_tbl {
  setting_id            Int       @id @default(autoincrement())
  sacco_name            String    @db.VarChar(100)
  registration_number   String?   @db.VarChar(50)
  contact_email         String?   @db.VarChar(100)
  contact_phone         String?   @db.VarChar(20)
  address               String?   @db.Text
  membership_fee        Decimal   @db.Decimal(12, 2)
  loan_interest_default Decimal?  @default(12.00) @db.Decimal(5, 2)
  savings_interest_rate Decimal?  @default(3.00) @db.Decimal(5, 2)
  penalty_rate          Decimal?  @default(2.00) @db.Decimal(5, 2)
  max_loan_multiple     Decimal?  @default(3.00) @db.Decimal(5, 2)
  financial_year_start  DateTime? @db.Date
  logo_path             String?   @db.VarChar(255)
  created_at            DateTime  @default(now()) @db.Timestamp(0)
  updated_at            DateTime  @default(now()) @db.Timestamp(0)
}

model user_tbl {
  user_id       Int             @id @default(autoincrement())
  member_id     Int?
  fullname      String          @db.VarChar(150)
  idNumber      Int
  email         String          @db.VarChar(150)
  password      String          @db.VarChar(255)
  role          user_tbl_role
  status        user_tbl_status @default(Pending)
  last_login    DateTime?       @db.DateTime(0)
  create_at     DateTime        @default(now()) @db.DateTime(0)
  updated_at    DateTime        @default(now()) @db.DateTime(0)
  password_date DateTime        @default(now()) @db.DateTime(0)
}

model verification_tbl {
  id                Int       @id @default(autoincrement())
  user_id           Int
  email             String
  verification_code String    @db.VarChar(10)
  used              Boolean   @default(false)
  attempts          Int       @default(0)
  expires_at        DateTime  @db.DateTime(0)
  verified_at       DateTime? @db.DateTime(0)
  created_at        DateTime  @default(now()) @db.Timestamp(0)
}

enum loans_tbl_loan_type {
  Emergency_Loan   @map("Emergency Loan")
  Business_Loan    @map("Business Loan")
  Asset_Loan       @map("Asset Loan")
  Education_Loan   @map("Education Loan")
  Health_Insurance @map("Health Insurance")
  Other
}

enum caregivers_tbl_gender {
  Male
  Female
  Intersex
}

enum contributions_tbl_contribution_type {
  Shares
  Savings
  Membership_Fee @map("Membership Fee")
  Loan_Repayment @map("Loan Repayment")
  Penalty
}

enum contributions_tbl_payment_method {
  Cash
  Bank_Transfer     @map("Bank Transfer")
  Mobile_Money      @map("Mobile Money")
  Cheque
  Payroll_Deduction @map("Payroll Deduction")
}

enum user_tbl_role {
  Admin
  Data_Clerk @map("Data Clerk")
  Viewer
  Champion
  Member
}

enum childcare_survey_tbl_gender {
  Male
  Female
  Intersex
}

enum childcare_survey_test_gender {
  Male
  Female
  Intersex
}

enum sacco_members_tbl_status {
  Active
  Inactive
  Suspended
  Pending
}

enum user_tbl_status {
  Pending
  Active
  Suspended
  Deleted
  Blocked
}

enum loans_tbl_repayment_source {
  Salary_Deduction         @map("Salary Deduction")
  Cash_Deposit             @map("Cash Deposit")
  Standing_Order           @map("Standing Order")
  Savings_Account_Transfer @map("Savings Account Transfer")
}

enum members_tbl_membership_type {
  User
  Facility_In @map("Facility In")
  Individual
  Sacco_In    @map("Sacco In")
  CheckIn
}

enum beneficiaries_tbl_status {
  Active
  Inactive
  Graduated
  Deceased
}

enum caregivers_tbl_status {
  Active
  Inactive
  Suspended
}

enum contributions_tbl_status {
  Pending
  Declined
  Completed
  EMPTY_ENUM_VALUE @map("")
}

enum members_tbl_role {
  Admin
  Data_Clerk @map("Data Clerk")
  Viewer
  Assistant
  Member
  CheckIn
}

enum childcare_survey_tbl_received_training {
  Yes
  No
}

enum childcare_survey_test_received_training {
  Yes
  No
}

enum loans_tbl_status {
  Pending
  Active
  Closed
  Defaulted
  Declined
}

enum members_tbl_status {
  Active
  Inactive
  Suspended
  Pending
  Draft
  Declined
}

enum childcare_survey_tbl_received_certificate {
  Yes
  No
}

enum childcare_survey_test_received_certificate {
  Yes
  No
}

enum facilities_tbl_status {
  Active
  Inactive
  Pending
}

enum childcare_survey_tbl_interested_in_finance {
  Yes
  No
}

enum childcare_survey_test_interested_in_finance {
  Yes
  No
}

enum childcare_survey_tbl_status {
  Draft
  Pending
  Active
  Inactive
}

enum childcare_survey_test_status {
  Draft
  Pending
  Active
  Inactive
}
